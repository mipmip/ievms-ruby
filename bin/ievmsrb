#!/usr/bin/env ruby
require 'bundler/setup'
require 'ievms/windows_guest'
require 'thor'

class IevmsRb < Thor

  desc "cat [vbox name] [filename]", "cat file in VBox guest"
  def cat(vbox_name,guest_path)
    init vbox_name

    print @machine.download_string_from_file_to_guest guest_path, true
    print "\n"
  end

  desc "cmd [vbox name] [command to execute]", "Run command in cmd.exe"
  def cmd(vbox_name,command)
    init vbox_name

    print @machine.run_command command
    print "\n"
  end

  private

  def init vbox_name
    @machine = Ievms::WindowsGuest.new vbox_name
  end
end

IevmsRb.start(ARGV)
